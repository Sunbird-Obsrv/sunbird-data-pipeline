- name: Submit wfs job
  uri:
    url: https://spark-jobs-cluster.azurehdinsight.net/livy/batches
    user: "{{ admin_name }}"
    password: "{{ admin_password }}"
    method: POST
    body: "{{ lookup('template', './model-config.json.j2').wfs }}"
    force_basic_auth: yes
    body_format: json
    status_code: 201
    headers:
      X-Requested-By: "{{ admin_name }}"
  register: wfs_output
  tags:
    - submit-jobs

- debug:
    var: wfs_output  
    tags:
    - submit-jobs

- name: Submit course-dashboard-metrics job
  uri:
    url: https://spark-jobs-cluster.azurehdinsight.net/livy/batches
    user: "{{ admin_name }}"
    password: "{{ admin_password }}"
    method: POST
    body: "{{ lookup('template', './model-config.json.j2').course }}"
    force_basic_auth: yes
    body_format: json
    status_code: 201
    headers:
      X-Requested-By: "{{ admin_name }}"
  register: course_output 
  tags:
    - submit-jobs

- debug:
    var: course_output
    tags:
    - submit-jobs

- name: Submit assessment-metrics job
  uri:
    url: https://spark-jobs-cluster.azurehdinsight.net/livy/batches
    user: "{{ admin_name }}"
    password: "{{ admin_password }}"
    method: POST
    body: "{{ lookup('template', './model-config.json.j2').assessment }}"
    force_basic_auth: yes
    body_format: json
    status_code: 201
    headers:
      X-Requested-By: "{{ admin_name }}"
  register: assessment_output
  tags:
    - submit-jobs

- debug:
    var: assessment_output 
    tags:
    - submit-jobs
