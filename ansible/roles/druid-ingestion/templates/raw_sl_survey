{
   "type":"kafka",
   "dataSchema":{
      "dataSource":"sl-survey",
      "parser":{
         "type":"string",
         "parseSpec":{
            "format":"json",
            "timestampSpec":{
               "column":"completedDate",
               "format":"auto"
            },
            "dimensionsSpec":{
               "dimensions":[
                  {
                     "type":"string",
                     "name":"completedDate"
                  },
                  {
                     "type":"string",
                     "name":"createdAt"
                  },
                  {
                     "type":"string",
                     "name":"createdBy"
                  },
                  {
                     "type":"string",
                     "name":"criteriaExternalId"
                  },
                  {
                     "type":"string",
                     "name":"criteriaId"
                  },
                  {
                     "type":"string",
                     "name":"criteriaName"
                  },
                  {
                     "type":"string",
                     "name":"surveyId"
                  },
                  {
                     "type":"string",
                     "name":"surveyName"
                  },
                  {
                     "type":"string",
                     "name":"surveySubmissionId"
                  },
                  {
                     "type":"string",
                     "name":"questionAnswer"
                  },
                  {
                     "type":"string",
                     "name":"questionECM"
                  },
                  {
                     "type":"string",
                     "name":"questionExternalId"
                  },
                  {
                     "type":"string",
                     "name":"questionId"
                  },
                  {
                     "type":"string",
                     "name":"questionName"
                  },
                  {
                     "type":"string",
                     "name":"questionResponseLabel"
                  },
                  {
                     "type":"string",
                     "name":"questionResponseType"
                  },
                  {
                     "type":"string",
                     "name":"solutionExternalId"
                  },
                  {
                     "type":"string",
                     "name":"solutionId"
                  },
                  {
                     "type":"string",
                     "name":"solutionName"
                  },
                  {
                     "type":"string",
                     "name":"updatedAt"
                  },
                  {
                     "type":"string",
                     "name":"instanceParentId"
                  },
                  {
                     "type":"string",
                     "name":"instanceId"
                  },
                  {
                     "type":"string",
                     "name":"instanceParentResponsetype"
                  },
                  {
                     "type":"string",
                     "name":"instanceParentQuestion"
                  },
                  {
                     "type":"string",
                     "name":"questionSequenceByEcm"
                  },
                  {
                     "type":"string",
                     "name":"maxScore"
                  },
                  {
                     "type":"string",
                     "name":"minScore"
                  },
                  {
                     "type":"string",
                     "name":"percentageScore"
                  },
                  {
                     "type":"string",
                     "name":"pointsBasedScoreInParent"
                  },
                  {
                     "type":"string",
                     "name":"totalScore"
                  },
                  {
                     "type":"string",
                     "name":"scoreAchieved"
                  },
                  {
                     "type":"string",
                     "name":"totalpercentage"
                  },
                  {
                     "type":"string",
                     "name":"instanceParentExternalId"
                  },
                  {
                     "type":"string",
                     "name":"instanceParentEcmSequence"
                  },
                  {
                     "type":"string",
                     "name":"remarks"
                  },
                  {
                     "type":"string",
                     "name":"total_evidences"
                  },
                  {
                     "type":"string",
                     "name":"evidence_count"
                  },
                  {
                     "type":"string",
                     "name":"instanceParentCriteriaId"
                  },
                  {
                     "type":"string",
                     "name":"instanceParentCriteriaExternalId"
                  },
                  {
                     "type":"string",
                     "name":"instanceParentCriteriaName"
                  },
                  {
                     "type":"string",
                     "name":"isAPrivateProgram"
                  },
                  {
                     "type":"string",
                     "name":"programId"
                  },
                  {
                     "type":"string",
                     "name":"programName"
                  },
                  {
                     "type":"string",
                     "name":"programExternalId"
                  },
                  {
                     "name":"questionResponseLabel_number",
                     "type":"float"
                  },
                  {
                     "type":"string",
                     "name":"channel"
                  },
                  {
                     "type":"string",
                     "name":"parent_channel"
                  },
                  {
                     "type":"string",
                     "name":"appName"
                  },
                  {
                     "type":"string",
                     "name":"organisation_name"
                  }
               ]
            }
         }
      },
      "metricsSpec":[
         {
            "type":"floatSum",
            "name":"question_response_number",
            "fieldName":"questionResponseLabel_number"
         }
      ],
      "granularitySpec":{
         "type":"uniform",
         "segmentGranularity":"day",
         "queryGranularity":"day",
         "rollup": false
      }
   },
   "tuningConfig":{
      "type":"kafka",
      "reportParseExceptions":false,
      "maxRowsPerSegment": 5000000
   },
   "ioConfig":{
      "topic":"{{env}}.ml.survey.druid",
      "consumerProperties":{
         "bootstrap.servers":"{{kafka_brokers}}"
      },
      "taskCount":"{{sl_survey_task_count}}",
      "replicas":1,
      "taskDuration":"PT14400S",
      "useEarliestOffset": true,
      "completionTimeout": "PT1800S"
   }
}
